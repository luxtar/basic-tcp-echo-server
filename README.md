# basic-tcp-echo-server

### Multi Process Server

멀티 프로세스는 부모 프로세스가 자신의 프로세스를 복제하여 자식 프로세스를 생성해서 처리하는 방식으로 여러개의 프로세스로 다중 처리를 하는 방식이다.  
이것을 서버 운용 방식에 응용한 멀티 프로세스 서버는 클라이언트 세션을 프로세스 단위로 나누어서 처리하여 다중 접속, 다중 요청 처리를 가능하게 한다.  
멀티 프로세스는 프로세스들마다 격리된 환경이기 때문에 부모 프로세스와 자식 프로세스간에 변수 공유가 불가능하다.  
그래서 데이터를 공유하기 위해서는 프로세스간 통신 방식인 IPC나 공유메모리를 이용해야한다.  
  
리눅스 C에서 멀티 프로세스 서버는 fork를 이용해 개발할 수 있다.  
예제 소스는 멀티 프로세스 방식의 에코 서버 애플리케이션이다.  
서버 프로세스가 클라이언트 세션을 생성할 때 마다 fork를 통해 새로운 프로세스를 생성한다.  
fork의 리턴값은 해당 프로세스 pid 값인데 자식 프로세스일 경우 0을 리턴한다.  
따라서 fork 리턴값이 0일 분기를 자식프로세스가 생성된 시점으로 처리해주면 된다.  
fork는 프로세스 단위이기때문에 변수 공유가 불가능하다 했다.  
하지만 프로세스 복제가 일어나면서 변수도 복제가 일어나기 때문에 예제에서는 자식 프로세스에서 클라이언트 소켓 fd를 이용해 세션을 사용할 수 있다.  
소스 중간에 "signal(SIGCHLD, SIG\_IGN);" 부분이 있는데 해당 부분은 좀비 프로세스 발생을 방지 하기 위한 것이다.

멀티 프로세스의 장점은 프로세스마다 격리된 환경이기때문에 프로세스간에 서로 미치는 영향 요소가 적고 디버깅이 수월하다.  
단점은 자신의 프로세스를 복제하기때문에 프로세스를 생성하는 데에 소모되는 자원이 크기때문에 멀티쓰레드 방식보다 속도가 느리다.  
따라서 웹 서버같이 세션 확립 요청이 잦은 환경에서는 적합하지 않고 자원 이슈에 대한 비중이 크지 않고 요청이 잦지 않은 환경에서는 멀티 프로세스 방식을 채택하는것이 효율적일 것이다.

### Multi Thread Server

멀티 쓰레드는 하나의 프로세스에서 여러개의 쓰레드 단위로 나누어서 다중 처리를 하는 방식이다.  
멀티 쓰레드 서버는 클라이언트 세션을 쓰레드 단위로 나누어서 처리한다.  
멀티 쓰레드는 같은 프로세스 내에 존재하기때문에 멀티 프로세스와는 달리 격리된 환경이 아니다.  
그래서 쓰레드간에 변수 공유가 가능하다.  
  
리눅스 C에서 멀티 쓰레드 서버는 pthread를 이용해 개발할 수 있다.  
예제 소스는 리눅스 C 기반의 멀티 쓰레드 방식의 에코 서버 애플리케이션이다.

멀티 쓰레드의 장점은 프로세스에 비해 경량된 요소이기 때문에 비교적 자원소모가 적고 속도가 빠르다.  
단점은 디버깅이 어렵고 격리되지 않은 환경으로 인해 특정 쓰레드에 문제가 생겼을 때 다른 쓰레드에 영향을 미칠 요소가 크다.  
따라서 신중하게 다루어야하며 요청이 잦은 서버나 빠른 속도가 필요한 환경에서는 멀티 쓰레드 방식을 선택하는것이 효율적일 수 있다.
